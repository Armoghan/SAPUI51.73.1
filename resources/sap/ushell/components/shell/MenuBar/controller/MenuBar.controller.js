// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel"],function(C,J){"use strict";return C.extend("sap.ushell.components.shell.MenuBar.controller.MenuBar",{onInit:function(){this.oContainerRouter=sap.ushell.Container.getRenderer().getRouter();this.oContainerRouter.getRoute("home").attachMatched(this._selectIndexAfterRouteChange,this);this.oContainerRouter.getRoute("openFLPPage").attachMatched(this._selectIndexAfterRouteChange,this);var v=new J({selectedKey:"None Existing Key"});this.getView().setModel(v,"viewConfiguration");this.oURLParsingService=sap.ushell.Container.getServiceAsync("URLParsing");this._selectIndexAfterRouteChange();},onMenuItemSelection:function(e){var s=e.getParameter("key");var c=sap.ushell.Container.getServiceAsync("CrossApplicationNavigation");Promise.all([this.oURLParsingService,c]).then(function(S){var u=S[0];c=S[1];var p=u.parseShellHash(s);c.toExternal({target:{semanticObject:p.semanticObject,action:p.action},params:p.params});});},_selectIndexAfterRouteChange:function(){return this.oURLParsingService.then(function(u){var h=u.parseShellHash(window.hasher.getHash());if(h.action==="home"){this.getView().getModel("viewConfiguration").setProperty("/selectedKey","");}else if(!h.params.pageId||!h.params.spaceId){this.getView().getModel("viewConfiguration").setProperty("/selectedKey","None Existing Key");}else{var k="#Launchpad-openFLPPage?spaceId="+window.encodeURIComponent(h.params.spaceId[0])+"&pageId="+window.encodeURIComponent(h.params.pageId[0]);this.getView().getModel("viewConfiguration").setProperty("/selectedKey",k);}}.bind(this));}});});
