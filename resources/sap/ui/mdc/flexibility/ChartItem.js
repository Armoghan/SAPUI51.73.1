/*!
 * SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/mdc/odata/v4/ChartDelegate","sap/ui/fl/changeHandler/Base"],function(M,F){"use strict";var r=function(c){clearTimeout(r.iTimer);r.iTimer=setTimeout(function(){if(c&&c.isA&&c.isA("sap.ui.mdc.Chart")){c._rebind();}});};var a=function(c,o,p,s){var m=p.modifier;var i=c.id?c.id:m.getControlIdBySelector(s,p.appComponent)+"--"+c.name;var b=m.getSelector(i,p.appComponent);var A=M.retrieveAggregationItem("items,",c);var I=m.bySelector(b,p.appComponent,p.view);if(!I){I=m.createControl(A.className,p.appComponent,p.view,i,A.settings);I.setProperty("role",c.role);var d=m.getAggregation(o,"items");var e=c.index>-1?c.index:d.length;m.insertAggregation(o,"items",I,e);}else{F.markAsNotApplicable("Specified change is already existing",true);}return I;};var R=function(c,o,p,s){var m=p.modifier;var i=c.id?c.id:m.getControlIdBySelector(s,p.appComponent)+"--"+c.name;var b=m.getSelector(i,p.appComponent);var I=m.bySelector(b,p.appComponent,p.view);if(!I){F.markAsNotApplicable("Specified change is already existing",true);}var d=m.findIndexInParentAggregation(I);m.removeAggregation(o,"items",I);m.destroy(I);return{item:I,content:c,index:d,selector:b,modifier:m};};var g=function(c,p){var m=p.modifier;var o=m.getSelector(c,p.appComponent);return m.bySelector(o,p.appComponent,p.view);};var G=function(c,p){var m=p.modifier;var o=c.getContent();return o.id?o.id:m.getControlIdBySelector(c.getSelector(),p.appComponent)+"--"+o.name;};var C={};C.removeItem={"changeHandler":{applyChange:function(c,o,p){var b=R(c.getContent(),o,p,c.getSelector());var A=M.retrieveAggregationItem("items,",b.content);c.setRevertData({id:b.content.id,label:b.modifier.getProperty(b.item,"label"),settings:A.settings,controlSelector:b.selector,index:b.index,role:b.content.role});},completeChangeContent:function(c,m,p){if((!c.getContent()||!c.getContent().id)&&m.removedElement){c.setContent(m.removedElement);}},revertChange:function(c,o,p){var m=p.modifier;var b=c.getRevertData();var A=M.retrieveAggregationItem("items",b);var d=b.controlSelector;var i=m.bySelector(d,p.appComponent,p.view);if(!i){i=m.createControl(A.className,p.appComponent,p.view,b.id,A.settings);i.setProperty("role",b.role);var I=m.getAggregation(o,"items");var e=b.index>-1?b.index:I.length;m.insertAggregation(o,"items",i,e);}c.resetRevertData();if(!b.preventRebind){r(o);}}},"layers":{"USER":true}};C.addItem={"changeHandler":{applyChange:function(c,o,p){var b=c.getContent();var d=a(b,o,p,c.getSelector());c.setRevertData({id:b.id,item:d.sId,role:b.role});if(!b.preventRebind){r(o);}},completeChangeContent:function(c,m,p){},revertChange:function(c,o,p){var m=p.modifier;var b=c.getRevertData();var d=m.getSelector(b.item,p.appComponent);var i=m.bySelector(d,p.appComponent,p.view);m.removeAggregation(o,"items",i);m.destroy(i);c.resetRevertData();}},"layers":{"USER":true}};C.moveItem={"changeHandler":{applyChange:function(c,o,p){var m=p.modifier;var i=G(c,p);return new Promise(function(b,d){var e=g(i,p);var O=m.findIndexInParentAggregation(e);if(!e){d(new Error("No item found. Change to move item cannot be applied at this moment"));return;}m.removeAggregation(o,"items",e);m.insertAggregation(o,"items",e,c.index);c.setRevertData({id:i,index:O});b();});},completeChangeContent:function(c,m,p){},revertChange:function(c,o,p){var m=p.modifier;var b=c.getRevertData();return new Promise(function(d,e){var f=g(b.id,p);if(!f){e(new Error("No item found. Change to move item cannot be reverted at this moment"));return;}m.removeAggregation(o,"items",f);m.insertAggregation(o,"items",f,b.index);c.resetRevertData();d();});}},"layers":{"USER":true}};return C;});
