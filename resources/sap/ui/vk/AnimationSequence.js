/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/base/Object","./AnimationTrackType","./findIndexInArray"],function(B,A,f){"use strict";var a=B.extend("sap.ui.vk.AnimationSequence",{constructor:function(i,p){this._id=i;this._name=p&&p.name?p.name:"";this._duration=p&&p.duration?p.duration:1.0;this._joints=[];this._animations=new Map();}});a.prototype.getId=function(){return this._id;};a.prototype.getName=function(){return this._name;};a.prototype.setName=function(n){this._name=n;return this;};a.prototype.getDuration=function(){return this._duration;};a.prototype.setDuration=function(d){this._duration=d;return this;};a.prototype._findJointIndex=function(p,n){return f(this._joints,function(j){return(p?j.parent==p:true)&&(n?j.node==n:true);});};a.prototype.setJoint=function(j){if(!Array.isArray(j)){j=[j];}j.forEach(function(d){var i=this._findJointIndex(d.parent,d.node);if(i<0){this._joints.push(d);}else{this._joints[i].translation=d.translation;this._joints[i].quaternion=d.quaternion;this._joints[i].scale=d.scale;}},this);return this;};a.prototype.getJoint=function(j){var r;if(!j||(!j.parent&&!j.node)){r=this._joints;}else if(j&&j.node){r=this._joints.filter(function(i){return i.node==j.node&&(j.parent?i.parent==j.parent:true);});}else if(j&&j.parent&&!j.node){r=this._joints.filter(function(i){return i.parent==j.parent;});}return r;};a.prototype.removeJoint=function(j){if(!j){this._joints.splice(0);}else if(j&&(j.node||j.parent)){var i;do{i=this._findJointIndex(j.parent,j.node);if(i>=0){this._joints.splice(i,1);}}while(i>=0);}return this;};a.prototype.getNodeAnimation=function(n,p){var c=function(n){var d=this._animations.get(n);var r;if(d){if(p){r=d[p];}else{r={nodeRef:n};for(var t in A){var b=A[t];if(d[b]){r[b]=d[b];}}}}return r;}.bind(this);var r;if(n&&!Array.isArray(n)){var d=this._animations.get(n);if(!d){return undefined;}r=p?d[p]:d;}else if(!n){r=[];this._animations.forEach(function(d,b){r.push(c(b,p));},this);}else{r=[];n.forEach(function(b){r.push(c(b,p));},this);}return r;};a.prototype.setNodeAnimation=function(n,p,t){var d=this._animations.get(n);if(!d){d={};this._animations.set(n,d);}d[p]=t;return this;};a.prototype.removeNodeAnimation=function(n,p){if(!p){this._animations.delete(n);}else{var d=this._animations.get(n);if(d){d.delete(p);}}return this;};a.prototype.getNodesStartValues=function(){var r=new Map();var g=function(t){if(t.getKeysCount()){var k=t.getKey(0);if(k.time===0){return k.value;}}return undefined;};var s=function(n,p,v){var d=r.get(n);if(!d){d={};r.set(n,d);}d[p]=v;};this._animations.forEach(function(d,n){var p=d[A.Translate];if(p){var b=g(p);if(b){s(n,"position",b);}}var c=d[A.Rotate];if(c){var e=g(c);if(e){s(n,"quaternion",e);}}var h=d[A.Scale];if(h){var i=g(h);if(i){s(n,"scale",i);}}});return r;};a.prototype.getNodesEndValues=function(){var r=new Map();var g=function(t){if(t.getKeysCount()){var k=t.getKey(t.getKeysCount()-1);return k.value;}return undefined;};var s=function(n,p,v){var d=r.get(n);if(!d){d={};r.set(n,d);}d[p]=v;};this._animations.forEach(function(d,n){var p=d[A.Translate];if(p){var b=g(p);if(b){s(n,"position",b);}}var c=d[A.Rotate];if(c){var e=g(c);if(e){s(n,"quaternion",e);}}var h=d[A.Scale];if(h){var i=g(h);if(i){s(n,"scale",i);}}});return r;};return a;});
