/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Tool","./RotatableAxis","./CoordinateSystem","./RotateToolHandler","./RotateToolGizmo","./Detector"],function(T,R,C,a,b,D){"use strict";var c=T.extend("sap.ui.vk.tools.RotateTool",{metadata:{properties:{coordinateSystem:{type:"sap.ui.vk.tools.CoordinateSystem",defaultValue:C.World},axis:{type:"sap.ui.vk.tools.RotatableAxis",defaultValue:R.All},enableStepping:{type:"boolean",defaultValue:false},enableSnapping:{type:"boolean",defaultValue:false},showEditingUI:{type:"boolean",defaultValue:false}},events:{rotating:{parameters:{x:"float",y:"float",z:"float"}},rotated:{parameters:{x:"float",y:"float",z:"float"}},axisChanged:{parameters:{axis:"sap.ui.vk.tools.RotatableAxis"}},coordinateSystemChanged:{parameters:{coordinateSystem:"sap.ui.vk.tools.CoordinateSystem"}}}},constructor:function(i,s){T.apply(this,arguments);this._viewport=null;this._handler=new a(this);this._gizmo=null;this._detector=new D();}});c.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(["sap.ui.vk.threejs.Viewport"]);this.setAggregation("gizmo",new b());};c.prototype.isViewportType=function(t){if(this._viewport&&this._viewport.getMetadata().getName()===t){return true;}return false;};c.prototype.setActive=function(v,d,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,d,g);}if(v){this._activateTool(d);}else{this._deactivateTool();}if(d){d.setShouldRenderFrame();}return this;};c.prototype._activateTool=function(d){this._viewport=this.getViewportImplementation(d);this._gizmo=this.getGizmo();this._gizmo.setAxis(this.getAxis());this._gizmo.setCoordinateSystem(this.getCoordinateSystem());this._gizmo.show(this._viewport,this);this._prepare();};c.prototype._deactivateTool=function(){if(this._viewport&&this._viewport._loco){this._viewport._loco.removeHandler(this._handler);}if(this._gizmo){this._gizmo.hide();this._gizmo=null;}};c.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler,12);o=true;}return o;};c.prototype.queueCommand=function(d){if(this._prepare()){if(this.isViewportType("sap.ui.vk.threejs.Viewport")){d();}}return this;};c.prototype.setAxis=function(v){var d=this.getAxis();if(d!==v){this.setProperty("axis",v,true);this.getGizmo().setAxis(v);if(this._viewport){this._viewport.setShouldRenderFrame();}this.fireAxisChanged({axis:v});}return this;};c.prototype.setCoordinateSystem=function(v){var d=this.getCoordinateSystem();if(d!==v){this.setProperty("coordinateSystem",v,true);this.getGizmo().setCoordinateSystem(v);if(this._viewport){this._viewport.setShouldRenderFrame();}this.fireCoordinateSystemChanged({coordinateSystem:v});}return this;};c.prototype.setShowEditingUI=function(v){this.setProperty("showEditingUI",v,true);if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};c.prototype.setEnableSnapping=function(v){this.setProperty("enableSnapping",v,true);if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};c.prototype.getDetector=function(){return this._detector;};c.prototype.rotate=function(x,y,z){if(this._gizmo){this._gizmo.rotate(x,y,z);}if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};return c;});
